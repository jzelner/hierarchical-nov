---
title: "Understanding the relative imporance of contact heterogeneity and variable infectiousness in the dynamics of a large Norovirus outbreak"
author: "Jon Zelner"
date: \today
subparagraph: yes
header-includes:
- \usepackage{graphicx}
- \usepackage{dsfont}
- \usepackage[compact]{titlesec}
- \usepackage{fancyhdr}
--- 

\titleformat{\section}{\normalfont\fontsize{13}{18}\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\fontsize{12}{15}\bfseries}{\thesubsection}{1em}{}

# Introduction

Norovirus outbreaks are stereotypically characterized by explosive dynamics in which many individuals become ill in quick succession. Such outbreaks may then rapidly fade out, continue to slowly collect cases, or exhibit a second outbreak peak as large or larger than the first one. Such unpredictable and explosive outbreak dynamics may indicate between-individual variation in infectiousness [@Lloyd-Smith:2005aa] leading to superspreading dynamics in which highly-infectious individuals account for a disproportionate share of transmission. In addition, patterns of contact in outbreak scenarios are likely to be clustered, e.g. with patients nested within wards during a nosocomial outbreak, children in classrooms [@Cauchemez:2011ab], or even animals on farms [@Haydon2003]. Analyses of large norovirus outbreaks e.g. [@Wikswo2011] have noted their wide variation in final size and duration and have strongly suggested that heterogeneous contact patterns and superspreading events may explain these dynamics.

Despite their importance for NoV outbreak prevention and control, the set of modeling tools that can capture these dynamics remains limited.  In a recent review, Gaythorpe et al. [@Gaythorpe2018] highlighted the fact that although NoV transmission models have shed important light on both outbreak and community transmission dynamics, models that explicitly incorporate sources of transmission heterogeneity are necessary to better explain real-world dynamics. In the current paper we address this need by examining the relative contributions of individual variation in infection heterogeneity and heterogeneous contact to the transmission dynamics of a large, previously published NoV outbreak in a Dutch scout jamboree [@Heijne2009]. This outbreak resulted in illness in > 300 individuals staying within 7 separate camps within the jamboree. Although individuals came into contact with those from other camps, it is likely that their contacts were most concentrated within their assigned camps, where they slept, ate and spent free time. A prior analysis of these data focused on the evoluton of the average infectiousness of cases across all camps. In this paper, we take advantage of the fact that individual time-series are available for each sub-camp to estimate the rate of within- vs. between-camp contact and the evolution of the daily reproduction number within each camp. This will allow us to assess whether certain camps likely acted as high-transmission *sources* of infection, that fed cases to lower-incidence camps, or if infectiousness between camps was roughly equivalent, with differences in incidence likely due to stochastic variaiton alone.

\paragraph{Sources of heterogeneous infectiousness} Heterogeneous infectiousness may result from between-individual variation in viral shedding, which may cause an individual to be more infectious on a per-contact basis than individuals who excrete fewer viral copies in each gram of stool or vomitus.  Individuals are likely to have variable contact rates as well: for example, those who are highly connected in community social networks may serve as 'hubs' of transmission. In institutional contexts, such as long-term care facilities or daycare centers, individuals are likely to be *clustered* into groups with varying sizes and within-group contact rates, such as wards or classrooms. High-transmission clusters may then serve as sources of infection that seed outbreaks in lower-transmission clusters in the same hospital, school, etc. Finally, the pathophysiology of NoV infection is likely to drive heterogeneity in the *effective* contact rate: A key feature of NoV infection is sudden-onset projectile vomiting. The location and timing of these events are likely to have a significant impact on the trajectory of an oubtreak. A vomiting event that occurs in public with many individuals nearby may be a significant source of infection. In addition,environmental contamination resulting from instances of public vomiting may allow transmission to occur days or weeks after the initial event, even following disinfection (CITE). At the same time, within the population expsed to an outbreak there is likely to be wide heterogeneity in susceptibility to infection upon exposure: Roughly 10% of the population is immune to NoV, and will not develop infection even when exposed to a large infectious dose (CITE). Individuals may acquire immunity following infection, with strong protection against reinfection with the same strain, and partial immunity to related variants in subsequent seasons.

Such contact heterogeneity, in combination with wide heterogeneity in individual infectiousness, may help to explain the "explosive, but self-limiting" character of large Norovirus outbreaks. Because transmission is often the result of vomiting events, the number of contacts an individual has around the time of illness onset is likely to be a key factor in determining his or her likelihood of either touching off a large outbreak or sustaining an ongoing one. For example, Wikswo et al. [@Wikswo2011] documented a large NoV outbreak in which an individual who vomited during boarding of a cruise ship likely infected many passengers at one time. This individual's impact on the outbreak was likely a function of both the magnitude of the event, i.e. in terms of viral particles shed into the environment, plus the number of individuals she contacted at the time of onset. Given an equally significant vomiting event within her own room, such a passenger would likely have had a diminished epidemiologic impact. 

# Methods

In this section, we desribe we construct a Bayesian hierarchical model of heterogeneous norovirus (NoV) outbreak transmission, which we apply to the previously published NoV outbreak data from  [@Heijne2009]. Our model builds on the framework for representing between-individual heterogeneity in infectiousness developed by Lloyd-Smith et al. [@Lloyd-Smith:2005aa] and allows explicit representation of 1) between-individual heterogeneity in infectiousness and 2) heterogeneous patterns of contact.

## Data

We analyze data previously published by Heijne et al. [@Heijne2009] from a large Norovirus outbreak during a scout jamboree in the Netherlands in 2004. Figure \ref{fig:allcases} shows the distribution of cases over time during the outbreak, and Figure \ref{fig:campcases} shows the evolution of the outbreak within the seven individual camps affected during the outbreak. 

## Transmission Model

In this section, we outline a stochastic, discrete-time model of NoV transmission within and between sub-camps involved in the outbreak. This model is similar to the susceptible-exposed-infectious-recovered (SEIR) models applied to NoV transmission in [@Zelner:2010aa; @Zelner2013], with key modifications to accomodate between-individual variability in infectiousness.

Lloyd-Smith et al. [@Lloyd-Smith:2005aa] describe an approach to modeling individual-level heterogeneity in infectiousness, in the context of *emerging* infections, to which the population is assumed to be completely susceptible and where the value of the population-level effective reproduction number is assumed to be below 1. This framework relies on the implicit assumption that large outbreaks are the result of a series of relatively improbable transmission events, rather than susceptible exhaustion. This assumption may not apply in the context of a large norovirus outbreak, such as the one described in [@Heijne2009] for two key reasons: 

1) The average value of $R$ may be larger than 1, indicating that susceptible depletion is a potential explanation for the end of the outbreak rather than reversion to the mean after a series of improbably infectious cases, and,

2) Outbreaks in institutional contexts, such as the scout camp in [@Heijne2009] or on a cruise ship [@Wikswo2011], often reflect transmission contexts subdivided into interacting sub-populations, such as camps or decks of a ship. 

In the following section, we describe an extension of this approach to the context of NoV outbreaks, specifically by modeling individual-level heterogeneity in *within-camp* infectiousness as well as the interaction between units. In our model, we denote the number of *incident* cases observed on day $t$ in camp $j$ to be $y_{jt}$. We denote the unobserved number of *infections* on day $t$ in camp $j$ as $y_{jt}^*$. These values are different because of the latent period between infection and onset of symptoms. Individuals are assumed to be infectious at the beginning of their day of onset. We denote the day of onset of disease for individual $i$ as $z_i$. 


\paragraph{Individual-level variation in infectiousness.} We assume that the expected number of secondary cases generated by each case varies across individuals, but that the proportion of secondary cases within the individual's camp, denoted as $\zeta$, is constant across individuals. We denote $R$ as the average number of secondary infections generated by each case, with $R_{W} = \zeta R$ equal to the number of secondary infections the individual would generate in her camp if she were the first infectious case and $R_{B} = R (1-\zeta)$ the number of cases she would generate in all other camps.


Each case is assumed to have an individual reproduction number $r_i$ identically and individually distributed from a Gamma distribution with shape parameter $R_{k}$ and a scale parameter $R_{\theta}$. So, $r_i \sim Gamma(R_{k}, R_{\theta})$, and population mean value $R = R_{k} * R_{\theta}$.  However, because within each camp multiple cases may become infectious on a given day, the values of $r_{i}$ for each case are not identifiable. However, we can take advantage of the fact that the sum of $n$ Gamma-distributed variables with shape $k$ and scale $\theta$ is Gamma distributed with shape parameter $nk$ and scale $\theta$ to sample values $r_{jt}$ indicating the daily *total force of infection* from all individuals who became infectious in camp $j$ on day $t$, which we denote as $\lambda_{jt} \sim Gamma(y_{jt}R_{k}, R_{\theta})$, where $y_{jt}$ is the number of incident infections in camp $j$ on day $t$.


\paragraph{Infectiousness as a function of time since symptom onset.} We follow the approach to modeling the change in individual infectiousness after symptom onset described in [@Cauchemez:2011aa] and previously applied to norovirus in [@Zelner2013]. In this framework, a probability mass function (PMF) is used to model the proportion of an individual's infectiousness occurring on each day following symptom onset (including the day of onset). In the current model, we allow individual infectiousness to decay according to a Geometric distribution with parameter $\gamma \in (0,1]$, where:

$$
g(x | \gamma) = \gamma (1-\gamma)^x 
$$

When $t \ge z_i$, $g(t-z_i)$ is the proportion of the infectiousness of individual $i$ deposited on day $t$. Otherwise, when $t < z_i$, this value is equal to zero, i.e. before the individual becomes infectious. The parameter $\gamma$ has a straightforward interpretation as the proportion of the individual's infectiousness deposited on the day of symptom onset, and the proportion of *remaining* infectiousness deposited each day thereafter.

\paragraph{Force of infection.} We denote the parameter $R^{B}$ to be the expected number of cases each infectious individual will create in *all other* camps except his own. Combining this with the values of within-camp infectiousness, $r^{W}_{jt}$, we can write the force of infection within each camp at each time, $t$, as follows:  

$$
\lambda_{jt} =  \sum_{k \le t}g(t-k) \left( \frac{{r}_{jk}}{n_{j}}+ \sum_{i \ne j} \frac{y_{ik}R^{B}}{(N-n_{i})} \right)
$$

The risk of infection posed by each case to individuals in the other camps is a function of the size of the population outside his or her camp, i.e. $N-n_j$ for an individual residing in camp $j$. 

\paragraph{Latent period.} We utilize the estimates of the mean and variance of NoV incubation period duration published by Lee et al. [@Lee2013] in their systematic review of incubation periods for viral gastroenteritis. Lee et al. assume that NoV incubation periods follow a log-Normal distribution, with a median incubation time of 1.2 days (95% CI = 1.2, 1.3 days) with a dispersion factor (corresponding to the variance of the underlying normal distribution) of 1.56 (95% CI = 1.49, 1.62). In practice, this means that 95% of cases will become symptomatic within 2.5 days of infection (95% CI 2.4-2.6 days). We use a discrete approximation to this value, where $g(x | \eta)$ is the probability mass function (PMF) of the Geometric distribution, where $\eta = 0.8$ is the probability of manifesting symptoms on each day following infection, for an average latent period of approximately 1.2 days. 

\paragraph{Missing data.} Although the outbreak data are notbale for their detail on contact, camp assignments are unknown for 30 out of the 326 cases (9%) (See Fig. \ref{fig:allcases}). The majority (18) of these missing cases occurred on or after the final day of the jamboree,  likely making their impact on overall outbreak size minimal. However, to account for the potential effect of these cases on estimates of the infectiousness of cases observed on prior days of the outbreak, we created 20 random datasets with these unobserved cases distributed uniformly at random across the camps. The model was then fit to each of these augmented datasets, and the posterior distributions obtained from 20 augmented datasets were combined into a single distribution that reflects uncertainty in these case assignments. This is analogous to a weighting scheme in which each input dataset is assigned an equal sampling weight. 

# Results
```{r, warning=FALSE, message=FALSE, echo=FALSE}
require(readr)
require(dplyr)
require(rstan)
require(glue)

par_format <- function(x) {
 xq <- quantile(x, probs = c(0.025, 0.5, 0.975))
  xf <- sprintf("%0.2f (%0.2f, %0.2f)", xq[2], xq[1], xq[3]) 
}
## Load pars

z <- read_csv("../output/scalar_pars.csv")


zeta <- z %>% filter(par == "zeta")
zeta_format <- sprintf("%0.2f, (%0.2f, %0.2f)", 1-zeta$median, 1-zeta$high_ci, 1-zeta$low_ci)
beta <- z %>% filter(par == "log_beta_mu") 
beta_format <- sprintf("%0.2f, (%0.2f, %0.2f)", exp(beta$median), exp(beta$low_ci), exp(beta$high_ci))
beta_shape <- z%>% filter(par == "beta_shape")
beta_shape_format <- sprintf("%0.2f, (%0.2f, %0.2f)", beta_shape$median, beta_shape$low_ci, beta_shape$high_ci)

gamma <- z %>% filter(par == "gamma")
gamma_format <- sprintf("%0.2f, (%0.2f, %0.2f)", gamma$median, gamma$low_ci, gamma$high_ci)

zz <- readRDS("../output/nov_model.Rds") %>% extract

camp_avg <- exp(zz$log_beta_mu)
between_avg <- zz$zeta

camp_ci <- quantile(camp_avg, probs = c(0.025, 0.975))
between_ci <- quantile(between_avg, probs = c(0.025, 0.975))

## Load probability of infection within camp
infection_source <- readRDS("../output/infection_source.Rds")

inf_q <- infection_source$within_camp$p_within %>% quantile(probs = c(0.025, 0.5, 0.975))
tm <- par_format(exp(zz$log_beta_mu) + zz$zeta)
gm <- par_format(zz$gamma)
```

\paragraph{Average and individual-level infectiousness.} The average reproduction number $R=$ `r beta_format`. For each case, approximately $\zeta =$ `r zeta_format` of secondary infections occurred within his camp, suggesting a per-capita within-camp transmission rate approximately seven times greater than the between-camp per-capita transmission rate. The value of $r_i$ across individuals is highly dispersed, $\alpha$ = `r beta_shape_format`, indicating wide heterogeneity in infectiousness across individuals. This is suggestive of a superspreading dynamic in which the large majority of cases had $r_i < 1$, while a small number of cases was responsible for the bulk of within and between-camp burden. Almost all infectiousness was concentrated on the day of onset, as indicated by the parameter estimate $\gamma=$ `r gm`. These results echo the finding from [@Zelner2013], which found a strong concentration of individual infectiousness on the day of illness onset.


Figure \ref{fig:dailyr} shows the evolution of $\bar{r}_{t}$ across all camps over the course of the outbreak. This suggests a pattern in which average infectiousness was indeed reduced in the period following the onset of interventions on day 3 of the outbreak, but with a number of large transmission events several days after the implementation of intensive hygiene interventions. Figure \ref{fig:campr} shows the total force of infection (i.e. within-camps + between camp) for each day of the outbreak, $\lambda_{jt}$. Notably, transmission within each camp except for camp 2 is characterized by a combination of sporadic super-spreading events and very low transmission, rather than a time-constant rate of infectiousness. In camp 2, the total infectiousness is roughly constant for the first 6 days of the outbreak, reflecting the large overall burden of illness in that camp and suggesting that it was driven largely by endogeneous transmission.


\paragraph{Between vs. within-camp transmission.} The parameter $\zeta$ indicates the total proportion of infections expected to be generated within vs. between camps. To understand how the contributions of individual camps to the overall outbreak vary, we can disaggregate this value to estimate the proportion of infection occurring within each camp, which we denote as $\zeta_j$.  To do this, we calculated 1) the proportion of the total force of infection experienced in each camp over all days of the outbreak that was attributable to within-camp exposure, i.e. $\zeta_j = \sum_{t=0}^{T}\frac{\lambda^{W}_{jt}}{\lambda^{B}_{jt} + \lambda^{W}_{jt}})$ Figure \ref{fig:camp_p} illustrates variation in the poprortion of infection acquired within vs. between-camp as a function of the total outbreak incidence acocunted for by that camp. The figure suggests a source-and-sink pattern in which endogenous transmission in high-incidence camps (2 & 3) fed cases into the medium (1, 6, 7) and low-incidence (4, 5) camps.

# Discussion

Our results suggest that the per-capita transmission rate within camps was significantly greater than between camps, but that cases generated roughly as many secondary cases in camps other than their own because the pool of susceptible individuals in other camps was roughly 6 times greater than within-camp for each case. The wide heterogeneity in average infectiousness across camps suggests a source-and-sink dynamic in which camps with greater average infectiousness fed cases into those with a lower average transmission rate. These results suggest that interventions concentrated on identifying and targeting high-transmission sub-populations within an outbreak may be a more efficient use of resources than implementing intensive facility-wide procedures. In addition,the wide variation in individual infectiousness suggests that the hazard of infection in outbreak data may only be weakly related to the number of incident cases in the population

It is important to note how our estimates of the evolution of infectiousness over time from all camps differ from those presented by Heijne et al. [@Heijne2009]. This is likely attributable to some key differences in model structure. For exmaple, our model shows an early peak in infectiousness on the second day of the outbreak, whereas in the prior anaysis, the largest peak occurred on the first day. This likely results from the fact that our model uses an explicit representation of the latent period rather than a generation-time approach. Our model also demontrates two peaks of infectiousness on the days following the beginning of interventions, whereas the model in [@Heijne2009] shows a pattern of declining average infectiousness during this period. This may be attributable to the fact that our model accounts for susceptible depletion over the course of the outbreak, which reduces the number of individuals available to infect and necessarily reduces the *effective reproduction number*, which measures the number of realized infections. Since our model captures infection *potential*, i.e. the expected number of secondary infections on the first day of the outbreak, peaks in the average infectiousness of secondary cases are more readily detectable.

Our analysis has several limitations. The missingness of camp assignments for approximately 9% of cases may impact our estimates of within- and between-camp infectiousness. However, comparison of results obtained by integrating over 20 augmented datasets and the raw data in which cases with missing camp assignments were dropped, had no impact on our qualitative or quantitative results. This is likely because most of these cases came at the end of the outbreak, so that their impact of on subsequent transmission dynamics is blunted. In addition, it is important to note that although our model suggests the importance of transmission heterogeneity not explicitly modeled in an earlier analysis of these data, it is not possible from the present analysis to suggest that this model has better predictive properties. A formal model comparison, which is outside the scope of this analysis, would be an important contribution that would allow us to assess the relative utility of different outbreak models for predicting both the burden and tempo of NoV outbreaks. 

The present analysis may also contribute tools that will be useful for modeling future norovirus outbreaks as well as transmission of other pathogens characterized by large amounts of between-individual heterogeneity in transmission. Although the data were aggregated to the day, so that exact times of onset for individual cases were not available, we were able to estimate between-individual variation in infectiousness by taking advantage of the fact that the sum of gamma-distributed randomv ariables is also gamma distributed. This framework may be useful for modeling between-individual heterogneity in transmission in other contexts as well, as such daily counts are a common way of reporting outbreak data.

\clearpage

# Figures & Tables
```{r echo=FALSE}
par_format <- function(x) {
 xq <- quantile(x, probs = c(0.025, 0.5, 0.975))
  xf <- sprintf("%0.2f (%0.2f, %0.2f)", xq[2], xq[1], xq[3]) 
}
gm <- par_format(zz$gamma)
zm <- par_format(zz$zeta)
rm <- par_format(exp(zz$log_beta_mu))
tm <- par_format(exp(zz$log_beta_mu) + zz$zeta)
```
Parameter     Definition                                        Estimate (95% CI)
---------     ----------                                        ---------------
$\gamma$      Proportion of infectiousness each day             `r gamma_format`
$R$           Average individual reproduction number            `r beta_format`
$\zeta$       Proportion of infections within camp               `r zeta_format`
$\alpha$      Dispersion of case-level infectiousness            `r beta_shape_format`

Table: Parameters and their values

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{output/figures/all_camp_cases.pdf}
\caption{Number of new cases per day. Dashed vertical line indicates beginning of hygiene interventions; dotted line indicates end of jamboree.}
\label{fig:allcases}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{output/figures/cases_by_camp.pdf}
\caption{Number of incident cases in each camp by day of outbreak. Dashed vertical line indicates beginning of hygiene interventions; dotted vertical line indicates end of jamboree.}
\label{fig:campcases}
\end{figure}


\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{output/figures/daily_avg_r.pdf}
\caption{Estimated daily avg. reproductive number across all camps. Dashed lines indicated 95\% posterior credible intervals. Dotted line indicates critical value of R = 1.}
\label{fig:dailyr}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{output/figures/daily_camp_r.pdf}
\caption{Estimated daily avg. reproductive number for each camp.Vertical bar indicates beginning of hygiene interventions.}
\label{fig:campr}
\end{figure}


\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{output/figures/p_by_camp.pdf}
\caption{Proportion of infections acquired within-camp, as a function of the total proportion of incident cases within that camp. Points indicated posterior medians; vertical bars indicated 95\% posterior credible intervals. Each point is labelled by the camp in Figure \ref{fig:campcases} it corresponds to.}
\label{fig:camp_p}
\end{figure}



\clearpage

# Supplementary Methods


## Likelihood

The likelihood of observing *each* of the $y_{jt}$ cases in camp $j$ on day $t > 1$ is a function of three components: 

1) Likelihood of escaping infection from $t=1$ until the time of infection for case $i$, $t_{i}^*$.

2) Likelihood of infection in camp $j$ at $t = t^*_i$, and,

3) Likelihood of latent period of duration $z_i - t_i^*$, where $z_i$ is the time of onset for case $i$.

The total system likelihood involves a fourth component:

4 ) Likelihood that the $S_j$ individuals in camp $j$ who did not develop disease during the observation period escaped infection from $t = 1$ until time $T$, when the jamboree ended.

The probability that an individual is infected at time $t_i^*$ is a function of a piecewise exponential likelihood, i.e. 1 and 2 above:

$$ 
Pr(t = t^*_{ij}) = \left(1- e^{-\lambda_{jt}}\right) exp\left(-\sum_{i = 1}^{i < t} \lambda_{ji}\right)
$$


The probability that an individual has a latent period of $z_i - t_i^*$ is described by a geometric distribution with rate parameter $\epsilon$:

$$
Pr(x  = z_i-t^*_{ij}) = \epsilon (1-\epsilon)^{(z_i-t^*_{ij}-1)}
$$

For case $i$, the marginal probability - summing over all possible latent periods - that $t = z_i$ is:

$$
Pr(z_i = t) = \sum_{j = 1}^{z_i - 1} \frac{Pr(j = t^*_{ij}) Pr(x = z_i-j)}{\sum_{k = 1}^{z_i-1}{Pr(x = z_i - k)}}
$$

Then, for all camps, $j$, the probability of observing $y_{j2}$ cases on day 2, ${y_j3}$ on day 3, etc, is:

$$
Pr(y_{jt}) = \prod_{i = 1}^{C} \prod_{t = 1}^{T} y_{it} Pr(z_i = i)
$$

\clearpage


# References
